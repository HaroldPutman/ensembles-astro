---
import { getCollection, render } from 'astro:content';
import type { CollectionEntry } from 'astro:content';
import Layout from '../layouts/Layout.astro';
import ActivityCard from '../components/ActivityCard.astro';

const activities = await getCollection('activities');

// Render markdown content for each event
const renderedActivities = await Promise.all(
  activities.map(async (activity: CollectionEntry<'activities'>) => {
    const { Content } = await render(activity);
    return {
      ...activity,
      Content
    };
  })
);
---


<Layout>
  <section>
    <h1>Classes</h1>
    {renderedActivities.map((activity) => (
      <ActivityCard
        activityId={activity.id}
        name={activity.data.name}
        image={activity.data.image}
        startDate={activity.data.startDate}
        startTime={activity.data.startTime}
        duration={activity.data.duration}
        repeat={activity.data.repeat}
        ageMin={activity.data.ageMin}
        ageMax={activity.data.ageMax}
        cost={activity.data.cost}
        instructors={activity.data.instructors}
      >
        <activity.Content />
      </ActivityCard>
    ))}
  </section>
</Layout>

<style>
  h1 {
    margin-bottom: 3rem;
    font-size: 2.5rem;
    color: #333;
  }

  .event-group {
    margin-bottom: 4rem;
  }

  h2 {
    font-size: 2rem;
    color: #444;
    margin-bottom: 2rem;
    padding-bottom: 0.5rem;
    border-bottom: 2px solid #eee;
  }

  .events-grid {
    display: grid;
    grid-template-columns: repeat(auto-fill, minmax(300px, 1fr));
    gap: 2rem;
  }

  /* Mobile styles */
  @media (max-width: 768px) {
    .events-grid {
      grid-template-columns: 1fr;
    }

    h1 {
      font-size: 2rem;
    }

    h2 {
      font-size: 1.75rem;
    }
  }
</style> 