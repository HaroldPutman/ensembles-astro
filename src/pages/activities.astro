---
import { getCollection, render } from 'astro:content';
import type { CollectionEntry } from 'astro:content';
import FullWidthLayout from '../layouts/FullWidthLayout.astro';
import ActivityCard from '../components/ActivityCard.astro';

const activities = await getCollection('activities');

// Render markdown content for each event
const renderedActivities = await Promise.all(
  activities.map(async (activity: CollectionEntry<'activities'>) => {
    const { Content } = await render(activity);
    return {
      ...activity,
      Content
    };
  })
);
---


<FullWidthLayout>
  <section class="activities-section">
    <h1>Classes</h1>
    <div class="activities-grid">
      {renderedActivities.map((activity) => (
        <ActivityCard
          activityId={activity.id}
          name={activity.data.name}
          image={activity.data.image}
          startDate={activity.data.startDate}
          startTime={activity.data.startTime}
          duration={activity.data.duration}
          repeat={activity.data.repeat}
          ageMin={activity.data.ageMin}
          ageMax={activity.data.ageMax}
          cost={activity.data.cost}
          instructors={activity.data.instructors}
        >
          <activity.Content />
        </ActivityCard>
      ))}
    </div>
  </section>
</FullWidthLayout>

<style>
  .activities-section {
    padding: 2rem;
  }

  h1 {
    margin-bottom: 2rem;
    font-size: 2.5rem;
    color: #333;
    padding: 0 1rem;
  }

  .activities-grid {
    display: grid;
    grid-template-columns: repeat(auto-fill, 320px);
    gap: 2rem;
    padding: 0 1rem;
    justify-content: center;
  }

  /* Responsive breakpoints */
  @media (max-width: 768px) {
    .activities-section {
      padding: 1rem;
    }

    .activities-grid {
      grid-template-columns: 320px;
      padding: 0;
      justify-content: center;
    }

    h1 {
      font-size: 2rem;
      padding: 0;
      text-align: center;
    }
  }
</style> 